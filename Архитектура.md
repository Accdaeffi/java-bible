# Монолит
Старо как мир, но просто и надёжно. Легко разрабатывать, легко деплоить, легко тестировать.
Из минусов - отвратительная скаляция, которая заключается в том, что надо развёртывать ВСЁ приложение на дополнительных серверах, трудности обновлений и редкие релизы, т.к. надо всё перезапускать.

# Микросервисы
Маленькие узкоспециализированные сервисы, изолированные друг от друга и взаимодействующие по независимому от технологии способу (например, HTTP/JSON).
Обычно говорят про архитектуру, построенную на них, которая: 
1. Довольно проста в деплое
2. Обладает лучшей скаляцией
3. Более надёжная (баг не выходит за пределы сервиса) 
4. Более технологически гибкая.

Но при этом эта архитектура 
1. Усложняет интеграционное тестирование
2. Деплой всё-таки сложнее монолита
3. Большие расходы - каждому сервису нужно своё отдельное внимание и, как минимум, своя отдельная БД
4. Надо больше ресурсов железа.

Сам размер микросервиса - предмет споров. Рекомендуется - примерно на 12 человек, но зависит от нужд скаляции.

# Облако
Больше концепт, чем что-то реальное - позволяет использовать виртуальные сервера, скрывающие под собой реальное железо.
Виртуалки != облако
Облако - это больше про надёжность и редублирование, например, про хранение одной и той же разной информации на разных серверах.
Микросервисы позволяют делать это проще и удобнее.

# Из чего состоит микросервисная архитектура?
## Gateway (Шлюз)
Эндпойнт, доступный другим сервисам - например, интернету или внутренней сети организации.
Представляет из себя интерфейс всей системы.
Нечто аля прокси и NAT - позволяет незаметно перенаправлять запрос клиента на конкретный микросервис.
Может быть и балансировщиком.

## Инстансы сервисов
Работает несколько одновременно - желательно не менее 3.
Могут динамически подниматься новые и останавливаться старые.

## БД
Обычно по одной на сервис - но не всегда.
Обычно у сервисов с большой скаляцией одна БД для записей и множество для чтения.
Могут использоваться разные СУБД - например, MySQL у одного сервиса и Mongo у другого.

## Сообщения
Часто используется - сервис выставляет API наружу, через которую получают сообщения, на основе которых и работают. 
Работает хорошо, обеспечивает всё, что надо - что ещё надо?

## Сервисы дальше в потоке
Это нормально, когда один сервис вызывает другой и заставляет его что-то делать. 
Например, сервис обработки поисковых запросов обращается к БД, чтобы узнать, что до этого искал этот человек, а потом обращается к сервису рекламы, чтобы всунуть контекстную рекламу.

# 12-факторное приложение
Или как сделать хорошие микросервисы.

1. Общая кодовая база.
2. Явно декларируемые и изолированные зависимости.
3. Конфигурация хранится в окружении.
4. Сторонние службы - лишь подключаемые ресурсы. Должна быть возможность лёгкой замены одного из них на другой.
5. Чёткое разделение сборки (создание исполняемого пакета), релиза (объединение пакета с конфигурацией) и развёртывания (запуск пакета с конфигурацией).
6. Приложение должно быть stateless и не должно иметь разделяемые ресурсы (share-nothing). Если что-то надо хранить - БД в помощь.
7. Сервисы должны быть доступны через порты - т.е. должна осуществляться привязка портов.
8. Приложение должно масштабироваться с помощью запуска процессов параллельно.
9. Максимально быстрый и надёжный запуск и остановка в любой момент.
10. Окружение разработки, тестирования и прода должны быть максимально похожи.
11. Логирование должно быть потоком событий и должно выводится в stdout. При разработке - удобство отладки, а при работе - можно перехватывать и отправлять в лог файлы.
12. Одни и те же скрипты администрирования должны работать и на разработке, и на тестах, и на проде. 

# Список литературы
https://12factor.net/ - 12-факторное приложение
https://habr.com/ru/post/258739/ - 12-факторное, но на русском